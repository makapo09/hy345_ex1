Όταν ανοίγεις ένα αρχείο στη C χρησιμοποιώντας τη συνάρτηση open(), χρειάζεται να δώσεις ορισμένα flags που καθορίζουν πώς θέλεις να ανοίξεις το αρχείο (π.χ., μόνο για εγγραφή ή ανάγνωση) και ποια δικαιώματα θα έχει το αρχείο.

1. O_WRONLY, O_TRUNC, O_CREAT
Αυτά είναι flags που καθορίζουν πώς θα ανοίξεις το αρχείο.

O_WRONLY: Άνοιγμα αρχείου μόνο για εγγραφή (write-only).
O_TRUNC: Αν το αρχείο υπάρχει ήδη, τότε το κάνει κενό (αφαιρεί τα περιεχόμενα).
O_CREAT: Αν το αρχείο δεν υπάρχει, τότε το δημιουργεί.
Παράδειγμα:

c
Αντιγραφή κώδικα
int fd = open("file.txt", O_WRONLY | O_CREAT | O_TRUNC);
Αυτό ανοίγει το αρχείο file.txt για εγγραφή. Αν δεν υπάρχει, το δημιουργεί. Αν υπάρχει, το αδειάζει και γράφει από την αρχή.

2. S_IRUSR, S_IWUSR, S_IRGRP, S_IWGRP
Αυτά καθορίζουν τα δικαιώματα του αρχείου που θα δημιουργηθεί, δηλαδή ποιος μπορεί να διαβάσει ή να γράψει στο αρχείο.

S_IRUSR: Ο χρήστης που το δημιούργησε έχει δικαίωμα ανάγνωσης.
S_IWUSR: Ο χρήστης που το δημιούργησε έχει δικαίωμα εγγραφής.
S_IRGRP: Οι υπόλοιποι χρήστες της ίδιας ομάδας έχουν δικαίωμα ανάγνωσης.
S_IWGRP: Οι υπόλοιποι χρήστες της ίδιας ομάδας έχουν δικαίωμα εγγραφής.
Όλα αυτά μαζί δημιουργούν το αρχείο με συγκεκριμένα δικαιώματα πρόσβασης.

Παράδειγμα πιο απλό:


int fd = open("file.txt", O_WRONLY | O_CREAT | O_TRUNC, S_IRUSR | S_IWUSR);
Αυτό σημαίνει:

Άνοιξε το αρχείο file.txt για εγγραφή.
Αν το αρχείο δεν υπάρχει, δημιούργησέ το.
Αν υπάρχει ήδη, άδειασέ το.
Ο χρήστης έχει δικαιώματα ανάγνωσης και εγγραφής στο αρχείο.
Πιο απλά:
O_WRONLY: Μόνο εγγραφή.
O_CREAT: Δημιουργία αν δεν υπάρχει.
O_TRUNC: Αδειάζει το αρχείο αν υπάρχει ήδη.
S_IRUSR | S_IWUSR: Δικαιώματα ανάγνωσης και εγγραφής για τον χρήστη.
Αν θέλεις κάτι πιο απλό για το άνοιγμα και γράψιμο σε αρχεία χωρίς να ανησυχείς για τα δικαιώματα, μπορείς να παραλείψεις τα δικαιώματα και να χρησιμοποιήσεις τα flags για την εγγραφή και δημιουργία αρχείου, όπως:


int fd = open("file.txt", O_WRONLY | O_CREAT);
Αυτό θα λειτουργήσει για πολλές περιπτώσεις απλά, ανοίγοντας το αρχείο ή δημιουργώντας το εάν δεν υπάρχει.